<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>深度学习笔记 | GeekJoe</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/post/">Posts</a></li>
      
      <li><a href="/note/">Notes</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">深度学习笔记</span></h1>

<h2 class="date">2019/10/20</h2>
</div>

<main>
<h1 id="深度学习笔记">深度学习笔记</h1>
<p>报错与解决</p>
<h3 id="报错与解决">报错与解决</h3>
<ol>
<li>
<p>UnicodeDecodeError: &lsquo;ascii&rsquo; codec can&rsquo;t decode byte 0xc2 in position 1496: ordinal not in range(128)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">/content/pythia/pythia/utils/vocab.py in __init__<span style="color:#f92672">(</span>self, vocab_file, embedding_dim, data_root_dir, *args, **kwargs<span style="color:#f92672">)</span>
    <span style="color:#ae81ff">122</span> 
    <span style="color:#ae81ff">123</span>             with open<span style="color:#f92672">(</span>vocab_file, <span style="color:#e6db74">&#34;r&#34;</span><span style="color:#f92672">)</span> as f:
--&gt; <span style="color:#ae81ff">124</span>                 <span style="color:#66d9ef">for</span> line in f:
    <span style="color:#ae81ff">125</span>                     self.itos<span style="color:#f92672">[</span>index<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> line.strip<span style="color:#f92672">(</span><span style="color:#f92672">)</span>
    <span style="color:#ae81ff">126</span>                     self.word_dict<span style="color:#f92672">[</span>line.strip<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">]</span> <span style="color:#f92672">=</span> index
 ...
UnicodeDecodeError: <span style="color:#e6db74">&#39;ascii&#39;</span> codec can<span style="color:#960050;background-color:#1e0010">&#39;</span>t decode byte 0xc2 in position 1496: ordinal not in range<span style="color:#f92672">(</span>128<span style="color:#f92672">)</span><span style="color:#e6db74">`</span>
</code></pre></div><p>Replace</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">with</span> open(vocab_file, <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;</span>) <span style="color:#66d9ef">as</span> f:
    lines <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>readlines()
    lines <span style="color:#f92672">=</span> [line<span style="color:#f92672">.</span>strip(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>) <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> lines]
    <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> lines
</code></pre></div><p>with</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">with</span> open(vocab_file, <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">utf-8</span><span style="color:#e6db74">&#34;</span>, errors<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">ignore</span><span style="color:#e6db74">&#34;</span>) <span style="color:#66d9ef">as</span> f:
    lines <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>readlines()
    lines <span style="color:#f92672">=</span> [line<span style="color:#f92672">.</span>strip(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>) <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> lines]
    <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> lines:
</code></pre></div></li>
<li>
<p>ValueError: optimizing a parameter that doesn&rsquo;t require gradients</p>
<p>reference:</p>
<p>​	<a href="https://spandan-madan.github.io/A-Collection-of-important-tasks-in-pytorch/">Some important Pytorch tasks - A concise summary from a vision researcher</a> &amp; <a href="https://github.com/amdegroot/ssd.pytorch/issues/109">ValueError: optimizing a parameter that doesn&rsquo;t require gradients</a></p>
<p>当optimizer更新权重时，默认<code>requires_grad=True</code>，所以当遇到<code>optimizer = optim.Adadelta(model.parameters(), rho=0.95, eps=1e-6)</code>时，会<code>raise</code>一个错误：<code>raise ValueError(&quot;optimizing a parameter that doesn't require gradients&quot;)</code>，所以直接将<code>model.parameters()</code>直接替换成<code>filter(lambda p: p.requires_grad, model.parameters())</code>就可以了。</p>
</li>
<li></li>
</ol>
</main>

  <footer>
  <script src="//yihui.name/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script async src="//yihui.name/js/center-img.js"></script>
  
  <hr/>
  © <a href="https://imlauzh.github.io">Joseph Lau</a> 2017 &ndash; 2019 | <a href="https://github.com/imlauzh">Github</a>
  
  </footer>
  </body>
</html>

