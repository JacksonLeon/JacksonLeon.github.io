<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?port=1313&mindelay=10&v=2" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Hexo建站备忘录 | GeekJoe</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/post/">Posts</a></li>
      
      <li><a href="/note/">Notes</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Hexo建站备忘录</span></h1>

<h2 class="date">2018/03/22</h2>
</div>

<main>
<p>使用Hexo与Github Pages服务一同搭建个人博客</p>
<!-- raw HTML omitted -->
<h2 id="添加功能">添加功能</h2>
<ul>
<li>
<p>添加permanant link</p>
</li>
<li>
<p>添加置顶</p>
<p>在<code>node_modules/hexo-generate-index-pin-top/lib/generate.js</code>中替换<code>top</code>为<code>sticky</code>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#e6db74">&#39;use strict&#39;</span>;
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">pagination</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;hexo-pagination&#39;</span>);
<span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">locals</span>){
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">config</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">config</span>;
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">posts</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">locals</span>.<span style="color:#a6e22e">posts</span>;
    <span style="color:#a6e22e">posts</span>.<span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">posts</span>.<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">sort</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) {
        <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">sticky</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">sticky</span>) { <span style="color:#75715e">// 两篇文章sticky都有定义
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">sticky</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">sticky</span>) <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">date</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">date</span>; <span style="color:#75715e">// 若sticky值一样则按照文章日期降序排
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">sticky</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">sticky</span>; <span style="color:#75715e">// 否则按照sticky值降序排
</span><span style="color:#75715e"></span>        }
        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">sticky</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">sticky</span>) { <span style="color:#75715e">// 以下是只有一篇文章sticky有定义，那么将有sticky的排在前面（这里用异或操作居然不行233）
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
        }
        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">sticky</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">sticky</span>) {
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>;
        }
        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">date</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">date</span>; <span style="color:#75715e">// 都没定义按照文章日期降序排
</span><span style="color:#75715e"></span>    });
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">paginationDir</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">pagination_dir</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;page&#39;</span>;
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">pagination</span>(<span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#a6e22e">posts</span>, {
    <span style="color:#a6e22e">perPage</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">index_generator</span>.<span style="color:#a6e22e">per_page</span>,
    <span style="color:#a6e22e">layout</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#39;index&#39;</span>, <span style="color:#e6db74">&#39;archive&#39;</span>],
    <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">paginationDir</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/%d/&#39;</span>,
    <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> {
      <span style="color:#a6e22e">__index</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
    }
  });
};
</code></pre></div></li>
<li>
<p>字数统计</p>
</li>
<li>
<p>……</p>
</li>
</ul>
<p>安装依赖就可以完成（不敢保证）</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;hexo-site&#34;</span>,
  <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;0.0.0&#34;</span>,
  <span style="color:#f92672">&#34;private&#34;</span>: <span style="color:#66d9ef">true</span>,
  <span style="color:#f92672">&#34;hexo&#34;</span>: {
    <span style="color:#f92672">&#34;version&#34;</span>: <span style="color:#e6db74">&#34;3.8.0&#34;</span>
  },
  <span style="color:#f92672">&#34;dependencies&#34;</span>: {
    <span style="color:#f92672">&#34;hexo&#34;</span>: <span style="color:#e6db74">&#34;^3.8.0&#34;</span>,
    <span style="color:#f92672">&#34;hexo-abbrlink&#34;</span>: <span style="color:#e6db74">&#34;^2.0.5&#34;</span>,
    <span style="color:#f92672">&#34;hexo-deployer-git&#34;</span>: <span style="color:#e6db74">&#34;^0.3.1&#34;</span>,
    <span style="color:#f92672">&#34;hexo-generator-archive&#34;</span>: <span style="color:#e6db74">&#34;^0.1.4&#34;</span>,
    <span style="color:#f92672">&#34;hexo-generator-category&#34;</span>: <span style="color:#e6db74">&#34;^0.1.3&#34;</span>,
    <span style="color:#f92672">&#34;hexo-generator-feed&#34;</span>: <span style="color:#e6db74">&#34;^1.2.2&#34;</span>,
    <span style="color:#f92672">&#34;hexo-generator-index-pin-top&#34;</span>: <span style="color:#e6db74">&#34;^0.2.2&#34;</span>,
    <span style="color:#f92672">&#34;hexo-generator-search&#34;</span>: <span style="color:#e6db74">&#34;^2.2.5&#34;</span>,
    <span style="color:#f92672">&#34;hexo-generator-searchdb&#34;</span>: <span style="color:#e6db74">&#34;^1.0.8&#34;</span>,
    <span style="color:#f92672">&#34;hexo-generator-tag&#34;</span>: <span style="color:#e6db74">&#34;^0.2.0&#34;</span>,
    <span style="color:#f92672">&#34;hexo-renderer-ejs&#34;</span>: <span style="color:#e6db74">&#34;^0.3.0&#34;</span>,
    <span style="color:#f92672">&#34;hexo-renderer-kramed&#34;</span>: <span style="color:#e6db74">&#34;^0.1.4&#34;</span>,
    <span style="color:#f92672">&#34;hexo-renderer-stylus&#34;</span>: <span style="color:#e6db74">&#34;^0.3.1&#34;</span>,
    <span style="color:#f92672">&#34;hexo-server&#34;</span>: <span style="color:#e6db74">&#34;^0.2.0&#34;</span>,
    <span style="color:#f92672">&#34;hexo-symbols-count-time&#34;</span>: <span style="color:#e6db74">&#34;^0.4.4&#34;</span>,
    <span style="color:#f92672">&#34;hexo-wordcount&#34;</span>: <span style="color:#e6db74">&#34;^3.0.2&#34;</span>,
    <span style="color:#f92672">&#34;tree&#34;</span>: <span style="color:#e6db74">&#34;^0.1.3&#34;</span>
  }
}
</code></pre></div><h2 id="配置hexo">配置Hexo</h2>
<h3 id="环境搭建">环境搭建</h3>
<p>要使用Hexo， 需要系统支持Node.js以及Git，根据不同系统进行安装。</p>
<ul>
<li>Node.js</li>
<li>Git</li>
</ul>
<h3 id="hexo">Hexo</h3>
<h4 id="安装hexo">安装Hexo</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ npm install hexo-cli -g	<span style="color:#75715e"># 安装hexo</span>
$ hexo init blog
$ cd blog
$ sudo npm install   <span style="color:#75715e"># 安装依赖组件</span>
$ hexo g    <span style="color:#75715e"># hexo generate</span>
$ hexo s    <span style="color:#75715e"># hexo server 本地查看</span>
</code></pre></div><ul>
<li>其他命令</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hexo new post <span style="color:#e6db74">&#34;post-name&#34;</span> <span style="color:#75715e"># 默认为post</span>
$ hexo new page <span style="color:#e6db74">&#34;page-name&#34;</span> <span style="color:#75715e"># 新建页面</span>
</code></pre></div><ul>
<li>简写</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hexo g <span style="color:#f92672">=</span><span style="color:#f92672">=</span> hexo generate
$ hexo s <span style="color:#f92672">=</span><span style="color:#f92672">=</span> hexo server
$ hexo n <span style="color:#f92672">=</span><span style="color:#f92672">=</span> hexo new
$ hexo d <span style="color:#f92672">=</span><span style="color:#f92672">=</span> hexo deploy
</code></pre></div><ul>
<li>本地环境查看</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hexo -v
</code></pre></div><ul>
<li>我的本地环境</li>
</ul>
<pre><code>hexo: 3.6.0
hexo-cli: 1.1.0
os: Windows_NT 10.0.16299 win32 x64
http_parser: 2.7.0
node: 9.8.0
v8: 6.2.414.46-node.21
uv: 1.19.2
zlib: 1.2.11
ares: 1.13.0
modules: 59
nghttp2: 1.29.0
napi: 2
openssl: 1.0.2n
icu: 60.2
unicode: 10.0
cldr: 32.0.1
tz: 2017c
</code></pre><h4 id="hexo-主题">Hexo 主题</h4>
<ul>
<li>安装主题</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hexo clean
$ git clone https://github.com/theme-next/hexo-theme-next.git themes/next
<span style="color:#75715e"># 这种方案下，会出现仓库上传到Git后，本文件夹会变成@，不会显示具体内容的情况</span>
</code></pre></div><ul>
<li>更新主题</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd themes/next
$ git pull
</code></pre></div><ul>
<li>启用主题</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Extensions</span>
<span style="color:#75715e">## Plugins: https://hexo.io/plugins/</span>
<span style="color:#75715e">## Themes: https://hexo.io/themes/</span>
theme: next
</code></pre></div><h2 id="github-pages">Github Pages</h2>
<p>GitHub Pages 主要用于管理自己的网站，不过，由于空间免费稳定，比较适合用来做搭建一个个人博客。</p>
<ul>
<li>
<p>创建自己的Github账号</p>
</li>
<li>
<p>创建repository
创建一个公共仓库用来存放网站静态内容，不过仓库名字必须是username/username.github.io，这是Github特殊的命名约定，你可以通过 <a href="https://username.github.io">https://username.github.io</a> 来访问自己的博客。</p>
</li>
</ul>
<h4 id="使用hexo-deploy部署">使用Hexo deploy部署</h4>
<ul>
<li>部署到Github</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#75715e"># Deployment</span>
<span style="color:#75715e">## Docs: https://hexo.io/docs/deployment.html</span>
deploy:
  <span style="color:#66d9ef">type</span>: git
  <span style="color:#66d9ef">repo: github</span>: git@github.com:username/username.github.io.git,master
</code></pre></div><p>注意空格</p>
<ul>
<li>安装扩展</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ npm install hexo-deployer-git --save
</code></pre></div><ul>
<li>执行</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hexo d    <span style="color:#75715e"># hexo deploy</span>
</code></pre></div><ul>
<li>Github Repository</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ git clone https://github.com/username/username.github.io.git .deploy/username.github.io
</code></pre></div><p>将之前创建的空repo clone到本地，每次hexo d生成的public文件夹下内容复制到刚刚的文件夹下，再push到master brunch下，就可以更新github端的内容，为此我们创建一个sh脚本文件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">hexo clean
hexo generate
cp -R public/* .deploy/JacksonLeon
cd .deploy/JacksonLeon
git fetch origin
git add .
DATE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>echo <span style="color:#66d9ef">$(</span>date --rfc-2822<span style="color:#66d9ef">)</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
git commit -m <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Auto builder by JacksonLeon CI: </span>$DATE<span style="color:#e6db74">&#34;</span>
git merge origin/master
git push origin master
</code></pre></div><p>每次添加完文章后直接运行脚本就可以了</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd */hexo/blog
$ ./deploy.sh
</code></pre></div><h2 id="coding-pages"><del>Coding pages</del></h2>
<p><del>由于国内访问Github速度比较慢，所以我们还可以使用 coding.net 的pages服务，大部分与Github pages设置相同，要注意的是，仓库名必须为用户名，不然会出现css解析错误以及404的现象。</del></p>
<p>改用Gitee，不过有个缺点，Gitee需要手动部署最新提交，自动部署属于VIP功能……还是以Github为主吧</p>
<ul>
<li>_config.yml</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#75715e"># Deployment</span>
<span style="color:#75715e">## Docs: https://hexo.io/docs/deployment.html</span>
deploy:
  <span style="color:#66d9ef">type</span>: git
  <span style="color:#66d9ef">repo</span>: 
    <span style="color:#66d9ef">github</span>: git@github.com:username/username.github.io.git,master
    <span style="color:#66d9ef">coding</span>: git@git.coding.net:username/username.git,master
</code></pre></div><ul>
<li>.deploy.sh</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">hexo clean
hexo generate
cp -R public/* .deploy/JacksonLeon
cd .deploy/JacksonLeon
git fetch origin
git add .
DATE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>echo <span style="color:#66d9ef">$(</span>date --rfc-2822<span style="color:#66d9ef">)</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
git commit -m <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Auto builder by JacksonLeon CI: </span>$DATE<span style="color:#e6db74">&#34;</span>
git merge origin/master
git push origin master
cd ..
cd ..
cp -R public/* .deploy/JacksonLeon.github.io
cd .deploy/JacksonLeon.github.io
git fetch origin
git add .
git commit -m <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Auto builder by JacksonLeon CI: </span>$DATE<span style="color:#e6db74">&#34;</span>
git merge origin/master
git push origin master

</code></pre></div><h2 id="欢迎大家访问">欢迎大家访问</h2>
<ul>
<li>
<p><a href="https://jacksonleon.github.io/">Blog on Github Pages</a></p>
</li>
<li>
<p><del><a href="https://jacksonleon.coding.me/JacksonLeon/">Blog on Coding Pages</a></del></p>
</li>
</ul>

</main>

  <footer>
  <script src="//yihui.name/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script async src="//yihui.name/js/center-img.js"></script>
  
  <hr/>
  © <a href="https://imlauzh.github.io">Joseph Lau</a> 2017 &ndash; 2019 | <a href="https://github.com/imlauzh">Github</a>
  
  </footer>
  </body>
</html>

